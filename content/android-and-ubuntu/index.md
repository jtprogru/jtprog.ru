---
categories: howto
cover:
  alt: howto
  caption: 'Illustrated by [Igan Pol](https://www.behance.net/dreamwolf97d61e)'
  image: howto.png
  relative: false
date: "2015-02-18T14:49:00+03:00"
tags:
- android
- ubuntu
- mtp
- udev rules
title: '[HowTo] Дружим Android и Ubuntu 14.04'
type: post
---

Я относительно недавно обзавелся довольно простой мобилкой - `HTC Desire 310` на `Android 4.2.2`. И все было нормально до тех пор пока мне не понадобилось подружить этот агрегат с моим ноутбуком, на котором стоит Ubuntu 14.04 LTS.

Много всего было прочитано в интернете про всякие танцы с бубном и прочие жертвоприношения, но все без результатно. Увы и Ах! Но на днях решение пришло само собой в процессе ковыряния [Хабра](http://habr.com/ru/) и поиска идеального решения для инкрементного бэкапа на определенный хард при его подключении.Само по себе решение оказалось довольно простым. Если в двух словах, то надо всего лишь добавить свою мобилку в список известных устройств для демона `udev` и включить это правило. Все произведенные действия делались мной в консоли. Из ПО мне понадобились консоль,  `mc` (Midnight Commander), `nano` (любой текстовый редактор). Так же очень помогла дружба с головой.

Ну а теперь по порядку. Первое что я делаю после запуска консоли и получения рут-прав (в основном всегда работаю в консоли под рутом, но это не обязательное условие, мне просто лень каждый раз вбивать свой длиннющий пароль и заветные 4 символа `sudo`) это, правильно, обновляю систему.

```bash
sudo -s 
apt-get update && apt-get upgrade && apt-get dist-upgrade
```

После обновления системы работать, лично мне, как-то приятнее и спокойнее. А для качественной дружбы нам необходимо узнать данные нашей мобилки, а именно такие поля как `idProduct` и `idVendor`. Делается это такой коммандой:

```bash
lsusb
```

Сразу скажу, что многие советуют получать более подробную информацию о ваших устройствах с помощью той же комманды и дополнительно параметра `-v`. Но стоит заметить, что для начинающих пользователей объем выданной информации может оказаться пугающе огромным, поэтому просто знайте, что в строке вида:

```bash
Bus 002 Device 058: ID 0bb4:0ce7 HTC (High Tech Computer Corp.)
```

После `ID` идет следующий порядок данных: `0bb4` - это `idVendor`, а `0ce7` - `idProduct` соответственно. Это все что нам требуется знать о нашей мобилке. И поверьте этого вполне достаточно. Далее для удобства запускаем Midnight Commander и в одной панели открывает путь `/lib/udev/rules.d/`, а в другой `/etc/udev/rules.d/`.

Далее необходимо найти файлик `/lib/udev/rules.d/69-libmtp.rules` и скопировать его в папку `/etc/udev/rules.d/`, после чего его именно там необходимо отредактировать (**Внимание!** Ваш мобильный телефон возможно уже там есть, поэтому будьте осторожны!) добавив по заданному там формату данные вашего телефона. У меня это получилось вот так:

```bash
# HTC Desire 310 (MTP+ADB)
ATTR{idVendor}=="0bb4", ATTR{idProduct}=="0ce7", SYMLINK+="libmtp-%k", MODE="660", GROUP="audio", ENV{ID_MTP_DEVICE}="1", ENV{ID_MEDIA_PLAYER}="1"
```

Это всего лишь две строки. В первой идет комментарий с описанием модели телефона, а во второй строке идет указание атрибутов по которым определяется ваша мобилка. После этого сохраняем файлик с правилами и перезапускаем udev командой:

```bash
/etc/init.d/udev restart
```

Теперь можно подключать вашу мобилку и смотреть все ее содержимое хоть в том же Наутилусе. Вы спокойно сможете увидеть как внутреннюю память телефона, так и содержимое флеш-карты вставленной в телефон.

На этом все! Profit!

**UPD:** Забыл сказать, что при заблокированном экране вы не увидите содержимого вашей мобилки! Поэтому перед подключением разлочиваем экран и наслаждаемся!

**UPD2:** Спасибо комментам ниже. Уточняю для всех и себя. Я начал действия в консоли с получения прав рута командой `sudo -s`, далее я все действия производил именно от его имени. Все редактирования файлов так же происходят от имени рута через консольный текстовый редактор `nano`.

**UPD3:** В связи с выходом в свет Ubuntu 15.04 (лично себе поставил Kubuntu 15.04 на свой ноутбук) данную тему считаю более не актуально, т.к. там адекватно реализована работа с MTP-устройствами.

**UPD4:** На всякий случай напоминаю (читайте комменты ниже). Чтобы вашу мобилку смогла увидеть после всех вышеуказанных настроек любимая вами Ubuntu на телефоне необходимо выбрать режим подключения к компьютеру `MTP`.

**UPD5:** Судя по статистике, эта проблема до сих пор актуальна. Чаще всего всплывает в Gnome и в Cinnamon. KDE в этом плане видимо больше повезло. С чем может быть связано это - для меня остается загадкой.

---
Если у тебя есть вопросы, комментарии и/или замечания – заходи в [чат](https://ttttt.me/jtprogru_chat), а так же подписывайся на [канал](https://ttttt.me/jtprogru_channel).
