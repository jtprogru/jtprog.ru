---
categories: howto
cover:
  alt: howto
  caption: 'Illustrated by [Igan Pol](https://www.behance.net/iganpol)'
  image: howto.png
  relative: false
date: "2019-05-22T12:27:22+03:00"
tags:
- btrfs
- linux
title: '[HowTo] Btrfs - работаем с разделом'
type: post
---
Привет, `%username%`! Неожиданно для себя я открыл такую файловую систему как BTRFS.

- Используйте команду `show` файловой системы `btrfs`, чтобы получить список всех файловых систем `btrfs` и какие устройства они включают.
- Команда добавления устройства `btrfs` используется для добавления новых устройств в смонтированную файловую систему.
- Команда баланса файловой системы `btrfs` уравновешивает (перезагружает) выделенные экстенты на всех существующих устройствах.

Пример всех этих команд для добавления нового устройства выглядит следующим образом:

## Добавить новое устройство в раздел btrfs

Создаем раздел с файловой системой btrfs

```bash
mkfs.btrfs /dev/device1
mount /dev/device1
```

Добавляем в него второй (трети,пятый) девайс

```bash
btrfs device add /dev/device2 /mount-point
```

## Балансировка btrfs между несколькими устройствами

Метаданные и данные на этих устройствах по-прежнему хранятся только в `/dev/device1`. Теперь сбалансируем btrfs так, чтобы метаданные распространились на все устройства.

```bash
btrfs filesystem balance /mount-point
```

Балансировка файловой системы займет некоторое время, поскольку она считывает все данные и метаданные файловой системы и перезаписывает их на новом устройстве.

## Удаляем устройство из btrfs раздела

Используйте команду удаления устройства btrfs, чтобы удалить подключенное устройство. Он перераспределяет любые используемые экстенты на другие устройства в файловой системе для безопасного удаления. Никаких ручных действий не требуется. Сначала создайте и смонтируйте несколько файловых систем btrfs.

```bash
mkfs.btrfs /dev/sdb /dev/sdc /dev/sdd /dev/sde
mount /dev/sdb /mnt
```

Добавим некоторые данные на файловую систему и запустим удаление необходимого устройства:

```bash
btrfs device delete /dev/sdc /mnt
```

На этом всё! Profit!

---
Если у тебя есть вопросы, комментарии и/или замечания – заходи в [чат](https://ttttt.me/jtprogru_chat), а так же подписывайся на [канал](https://ttttt.me/jtprogru_channel).
