---
title: '[HowTo] Удаляем фантомные файлы'
description: "Решение проблемы с фантомными файлами в ownCloud после ручного удаления через консоль: восстановление синхронизации и очистка кэша"
keywords:
  - owncloud фантомные файлы
  - owncloud очистка кэша
  - owncloud ошибки синхронизации
  - occ files:scan
  - owncloud команды консоли
date: "2017-05-25T15:41:28+03:00"
lastmod: "2017-05-25T15:41:28+03:00"
tags:
  - owncloud
  - linux
categories: ["HowTo"]
cover:
  image: howto.png
  alt: howto
  caption: 'Illustrated by [Igan Pol](https://www.behance.net/iganpol)'
  relative: false
type: post
slug: 'owncloud-rescan-dir'
---

Я очень давно пользуюсь такой прелестной вещью как ownCloud как на работе, так и для себя лично. Меня этот комбайн во всем устраивает. И я умудрился столкнуться с интересным глюком в его работе.

[ownCloud](https://owncloud.org) - это, на мой взгляд идеальное решение для ~~параноиков~~ тех, кто желает иметь свой GoogleDrive/Яндекс.Диск/Dropbox и еще несколько дополнительных плюшек в виде следующих бонусов:

1. Вы контролируете размер своего облачного хранилища - сколько жестких дисков купили, столько и используете;
2. У вас есть возможность его модернизировать и расширять функционал с помощью [плагинов](https://apps.owncloud.com);

А теперь к сути проблемы. Собственно говоря косяк воспроизводится следующим образом. Через веб-интерфейс ownCloud или через клиентское приложение заливаем файлы в собственное облако. После чего заходим туда по `ssh` и удаляем "ненужные" файлы ручками через консоль. У нас возникает проблема "призрак файла" потому, что в базе и кэше ownCloud файлы остались, а по факту исчезли. Исправить это можно довольно таки легко следующей командой:

```bash
cd /path/to/install/dir/owncloud 
sudo -u www-data ./occ files:scan --all
```

С данная команда перезапустит сканирование файлов в директориях пользователей, перестроит кэш, обновит информацию в базе данных.

Ошибка эта проявляется и в обратном направлении: когда заливаете файлы через консоль (`scp`, `ftp`), а в веб-интерфейсе файлов нет и в десктопных клиентах файлы не появляются.

На этом всё!

---

Если у тебя есть вопросы, комментарии и/или замечания – заходи в [чат](https://ttttt.me/jtprogru_chat), а так же подписывайся на [канал](https://ttttt.me/jtprogru_channel).

О способах отблагодарить автора можно почитать на странице "[Донаты](https://jtprog.ru/donations/)". 
