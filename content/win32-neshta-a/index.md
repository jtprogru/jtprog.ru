---
categories: Work
cover:
  alt: work
  caption: work
  image: work.png
  relative: false
date: "2015-03-19T19:11:00+03:00"
draft: false
author: "jtprogru"
slug: /win32-neshta-a/
tags:
- windows
- neshta
- virus
title: '[Virus] Win32.Neshta.A - устраняем последствия'
type: post
---

Собрал себе свежую рабочую лошадку работу работать. По характеристикам не самый сахар, но вроде сойдет. Поставил свежую винду семерку запускаю со своей рабочей флешки (которая только для рабочих нужд используется) DriverPack Solution последний и тут начинается интересное :-)

Начинают ставиться дрова, но при попытке открыть любую другую программу вылетает предложение открыть этот файлик (`.exe`) с помощью чего-либо. Ну быстрый гуглеж (благо со мной всегда мой верный персональный пони Asus K52J с Ubuntu 14.04 LTS на борту) показал, что это вирус и указал даже название - [`Win32.Neshta`](https://ru.wikipedia.org/wiki/Neshta). С википедии:

> `Win32.Neshta` — белорусский вирус 2005-го года. Название вируса происходит от белорусского слова "нешта", означающего "нечто". Программа является приложением Windows (exe-файл). Написана на Delphi. Размер оригинального вредоносного файла — 41 472 байта. Это файловый вирус — тот тип вируса, который уже не популярен в настоящее время.

В базах антивирусных программ `Neshta` определяется так:

- `Virus.Win32.Neshta` — [Антивирус Касперского](https://ru.wikipedia.org/wiki/%D0%90%D0%BD%D1%82%D0%B8%D0%B2%D0%B8%D1%80%D1%83%D1%81_%D0%9A%D0%B0%D1%81%D0%BF%D0%B5%D1%80%D1%81%D0%BA%D0%BE%D0%B3%D0%BE)
- `Win32.HLLP.Neshta` — [Dr. Web](https://ru.wikipedia.org/wiki/Dr._Web)
- `Win32.Neshta` — [NOD32](https://ru.wikipedia.org/wiki/NOD32)
- `Win32.Neshuta` — [Symantec](https://ru.wikipedia.org/wiki/Symantec)

Суть работы вируса была в следующем: Вирус просто удаляет строку которая отвечает за совместимость фалов `*.inc` и `*.exe`! По этому если у вас на компьютере 2 браузера то проблема решена! Так как вы нажимаете на один пытаясь его открыть,и вам выходит окошко `открыть с помощью` и выбираете другой браузер!

Примерно таким способом его можно вылечить:

1. Открываем `Regedit` от имени Администратора (желательно из безопасного режима);
2. Ищем вот эти пути:

```reg
[HKEY_CLASSES_ROOT\exefile\shell\open\command]
[HKEY_LOCAL_MACHINE\SOFTWARE\Classes\exefile\shell\open\command]
```

и пишем значения по умолчанию в обоих ключах:

```reg
@="%1" %\*
```

После чего идем в директорию `C:\Windows\` и удаляем нахрен волшебно появившийся файлик `svchost.com`. Главное не очкуем. Он там один такой и ничего лишнего вы не удалите. После чего можно проверить (из безопасного же режима) систему каким-нибудь `Dr.Web CureIt` или `AVZ`, тут кому что больше нравится. После смело грузимся в нормальном режиме и радуемся тому, как мы самостоятельно удалили целый вирус десятилетней давности.

**ЗЫЖ** Обязательно пользуйтесь нормальным антивирусом и фаерволом если вы виндузятник :-)

---
Если у тебя есть вопросы, комментарии и/или замечания – заходи в [чат](https://ttttt.me/jtprogru_chat), а так же подписывайся на [канал](https://ttttt.me/jtprogru_channel).
